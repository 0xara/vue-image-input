var ImageInput=function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t,r,n,i,o,a,s,l,c){"boolean"!=typeof a&&(l=s,s=a,a=!1);var u="function"==typeof r?r.options:r;e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,i&&(u.functional=!0)),n&&(u._scopeId=n);var f;if(o?(f=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},u._ssrRegister=f):t&&(f=a?function(){t.call(this,c(this.$root.$options.shadowRoot))}:function(e){t.call(this,s(e))}),f)if(u.functional){var h=u.render;u.render=function(e,t){return f.call(t),h(e,t)}}else{var p=u.beforeCreate;u.beforeCreate=p?[].concat(p,f):[f]}return r}function a(e){a.installed||(a.installed=!0,e.component(h.name,h))}var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=function(){function e(r,n){t(this,e),this.vm=r,this.field=n,this.errorsBag=[]}return s(e,[{key:"getReader",value:function(e){var t=this,r=new FileReader;return r.onload=function(e){t.vm[t.field]=e.target.result},r}},{key:"removeFile",value:function(){this.vm[this.field]=""}},{key:"isSizeValid",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e.validateSize(t,r);return n||this.pushError("fileSize"),n}},{key:"isMimeTypeValid",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e.validateMimeType(t,r);return n||this.pushError("mimeType"),n}},{key:"pushError",value:function(e){this.errorsBag.push(this.getErrorMessages()[e])}},{key:"getErrorMessages",value:function(){return this.errorMessages||{mimeType:"نوع فایل انتخابی اشتباه است!",fileSize:"سایز فایل انتخابی اشتباه است!",fileDimensions:"ابعاد فایل انتخابی اشتباه است!"}}}],[{key:"getFiles",value:function(e){var t=e.target.files||e.dataTransfer.files;return t.length?t:[]}},{key:"getFilesFirst",value:function(t){var r=e.getFiles(t);return r.length?r[0]:null}},{key:"validateSize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.size<=1024*t*1024}},{key:"validateMimeType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!t)return!0;t=t.split(",");for(var r=e.type,n=r.replace(/\/.*$/,""),i=0;i<t.length;i++){var o=t[i];if("."===(o=o.trim()).charAt(0)){if(-1!==e.name.toLowerCase().indexOf(o.toLowerCase(),e.name.length-o.length))return!0}else if(/\/\*$/.test(o)){if(n===o.replace(/\/.*$/,""))return!0}else if(r===o)return!0}return!1}}]),e}(),c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)},f=function(e){function t(e,i){return r(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return i(t,e),c(t,[{key:"createImage",value:function(e){this.errorsBag=[];var r=l.getFilesFirst(e);if(r){var n=this.isMimeTypeValid(r,".jpg, .jpeg,.png, .bmp"),i=this.isSizeValid(r,1);if(n&&i)return u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getReader",this).call(this,r).readAsDataURL(r),r}}},{key:"removeImage",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"removeFile",this).call(this)}},{key:"getErrorMessages",value:function(){var e=u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getErrorMessages",this).call(this);return e.fileDimensions="ابعاد فایل انتخابی اشتباه است!",e}}],[{key:"validateImageDimensions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t.width,t.height,window.URL||window.webkitURL),n=new Image;n.onload=function(){alert("The image width is "+this.width+" and image height is "+this.height)},n.src=r.createObjectURL(e)}}]),t}(l),h=o({render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{style:{border:"2px dashed #E0E0E0","border-radius":"10px",padding:"10px"},on:{dragover:function(e){e.preventDefault(),e.stopPropagation()},drop:function(t){return t.preventDefault(),t.stopPropagation(),e.onImageChange(t)},click:function(t){return t.stopPropagation(),e.handleOpenFileSelector(t)}}},[r("input",{staticStyle:{display:"none"},attrs:{accept:e.accept,type:"file",name:"image"},on:{change:e.onImageChange}}),e._v(" "),r("img",{staticStyle:{width:"100%"},attrs:{src:e.imageSrc}})])},staticRenderFns:[]},void 0,{name:"ImageInput",model:{prop:"value",event:"change"},props:{accept:{},src:{},placeHolder:{},value:""},data:function(){return{imageSrc:"",imageHandler:new f(this,"imageSrc"),defaultPlaceHolder:"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20xmlns%3Axlink%3D'http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink'%20viewBox%3D'0%200%201400%20933'%3E%3Cdefs%3E%3Csymbol%20id%3D'a'%20viewBox%3D'0%200%2090%2066'%20opacity%3D'0.3'%3E%3Cpath%20d%3D'M85%205v56H5V5h80m5-5H0v66h90V0z'%2F%3E%3Ccircle%20cx%3D'18'%20cy%3D'20'%20r%3D'6'%2F%3E%3Cpath%20d%3D'M56%2014L37%2039l-8-6-17%2023h67z'%2F%3E%3C%2Fsymbol%3E%3C%2Fdefs%3E%3Cuse%20xlink%3Ahref%3D'%23a'%20width%3D'20%25'%20x%3D'40%25'%2F%3E%3C%2Fsvg%3E"}},computed:{errors:function(){return this.imageHandler.errorsBag}},watch:{src:function(e){if(!e)return this.$emit("change",""),void(this.imageSrc=this.getPlaceHolder());e!=this.imageSrc&&(this.imageSrc=e)},errors:function(e){e.length&&(this.$emit("change",""),this.$emit("error",e),this.imageSrc=this.getPlaceHolder())},value:function(e){e||(this.imageSrc=this.getPlaceHolder())}},created:function(){this.imageSrc=this.src||this.getPlaceHolder()},methods:{onImageChange:function(e){var t=this.imageHandler.createImage(e);this.$emit("change",t)},handleOpenFileSelector:function(e){$(this.$el).find("input[type=file]").trigger("click")},getPlaceHolder:function(){return this.placeHolder||this.defaultPlaceHolder}}},void 0,!1,void 0,void 0,void 0),p={install:a},d=null;return"undefined"!=typeof window?d=window.Vue:"undefined"!=typeof global&&(d=global.Vue),d&&d.use(p),h.install=a,e.default=h,e}({});
